<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>é ç´„æˆåŠŸ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    body{background:#e8f0f6;}
    .card-box{max-width:500px;margin:60px auto;padding:40px;border-radius:22px;background:#fff;box-shadow:0 10px 20px rgba(0,0,0,.12);text-align:center;}
    .btn-main{background:#3f729b;color:#fff;border:0;border-radius:12px;padding:12px 30px;font-size:18px;}
    .btn-secondary{border:2px solid #3f729b;border-radius:12px;padding:12px 30px;font-size:18px;color:#3f729b;background:#fff;}
    .share{text-decoration:none;color:#3f729b;font-size:20px;}
  </style>
</head>
<body>
<div class="card-box">
  <h2 class="mb-3">âœ… é ç´„æˆåŠŸï¼</h2>
  <p>æ‚¨çš„é ç´„è³‡è¨Šï¼š</p>
  <p id="info" class="fw-bold"></p>
  <p id="info2" class="fw-bold"></p>
  <p>è«‹åœ¨é ç´„çš„é–€è¨ºæ™‚é–“å…§åˆ°å ´å ±åˆ°ï¼Œé€¾æœŸè‡ªå‹•å–æ¶ˆã€‚</p>
  <div class="mt-4 mb-3">
    <a href="index.html" class="btn-main w-100 mb-3">è¿”å›é ç´„é¦–é </a>
    <a href="query.html" class="btn-secondary w-100">æŸ¥è©¢/å–æ¶ˆé ç´„</a>
  </div>
  <a href="javascript:void(0)" onclick="shareMsg()" class="share d-block mt-2">ğŸ“¤ åˆ†äº«</a>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbwwmPF0rNrulXUSbRNOUwksOK2cXjV4X7tXu7W4FnwiZzVNuSFVkMcEUn_ga-UgZAXS/exec";

function getWeek(d){
  return 'æ˜ŸæœŸ'+'æ—¥ä¸€äºŒä¸‰å››äº”å…­'[new Date(d).getDay()];
}

(async ()=>{
  const params = new URLSearchParams(location.search);
  const id = params.get("id");
  if(!id) return alert("ç„¡é ç´„è³‡è¨Š");

  try {
    const res = await axios.get(API, { params: { action: 'getOne', id: id } });
    const o = res.data;
    document.getElementById("info").innerText = `${o.date} ${getWeek(o.date)}ï¼ˆ${o.slot}ï¼‰`;
    document.getElementById("info2").innerText = `å§“åï¼š${o.name}ï¼Œè™Ÿç¢¼ï¼š${o.num} è™Ÿã€‚`;
  } catch (err) {
    console.error(err);
    alert("ç„¡æ³•å–å¾—é ç´„è³‡æ–™");
  }
})();

async function shareMsg(){
  const txt = document.getElementById("info").innerText + "\n" + document.getElementById("info2").innerText;
  if(navigator.share){
    try {
      await navigator.share({ text: txt });
    } catch (e) {
      alert("å·²å–æ¶ˆåˆ†äº«");
    }
  } else {
    await navigator.clipboard.writeText(txt);
    alert("åˆ†äº«å…§å®¹å·²è¤‡è£½ï¼Œå¯è²¼åˆ° LINE æˆ– Messenger");
  }
}
</script>
</body>
</html>
