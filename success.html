<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>預約成功</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
body{background:#eaf2f8}
.card{max-width:680px;margin:60px auto;padding:28px;border:0;border-radius:18px;box-shadow:0 10px 28px rgba(47,79,114,.12)}
.icon{font-size:56px;line-height:1}
h1{font-weight:800;margin:10px 0 16px}
.info{font-size:20px;line-height:1.7}
.btn-main{background:#3b7096;border:0;color:#fff;padding:10px 20px;border-radius:12px}
</style>
</head>
<body>
<div class="card text-center">
  <div class="icon">✅</div>
  <h1>預約成功！</h1>
  <p class="text-muted">您的預約資訊：</p>

  <div id="detail" class="info mb-3">讀取中…</div>

  <div class="d-flex justify-content-center gap-3">
    <a href="index.html" class="btn btn-main">返回預約首頁</a>
    <a href="query.html" class="btn btn-outline-secondary">查詢/取消預約</a>
  </div>

  <div class="mt-3 text-secondary">
    📅 請在預約的門診時間內到場報到，逾期自動取消。
  </div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbxIAVoc2Rwdtpm9dYecLQ5fLQb64yjk12D1IIId1_TwN2ptzh6is23mTMjye0VJI71p/exec";

function qs(k){return new URL(location.href).searchParams.get(k)}
function weekdayStr(d){
  const w = ['日','一','二','三','四','五','六'];
  return '星期'+w[new Date(d+'T00:00:00').getDay()];
}

(async ()=>{
  const id = qs('id');
  if(!id){ document.getElementById('detail').innerText='缺少參數'; return; }

  try{
    const r = await axios.get(API,{params:{action:'detail', id}});
    if(r.data.error){ document.getElementById('detail').innerText=r.data.error; return; }
    const d = r.data;
    const wk = weekdayStr(d.date);
    // d.slot 例：早診；你若要顯示時段，可在 index.html 的 option data-time 帶入後寫到表；這裡先不顯示 time
    document.getElementById('detail').innerHTML =
      `<div>${d.date} ${wk}（${d.slot}）</div>
       <div class="text-muted">${d.submittedAt}</div>
       <div class="mt-2">姓名：<b>${d.name}</b>，號碼：<b>${d.num}</b> 號。</div>`;
  }catch(e){
    console.error(e);
    document.getElementById('detail').innerText='無法取得預約資料';
  }
})();
</script>
</body>
</html>
